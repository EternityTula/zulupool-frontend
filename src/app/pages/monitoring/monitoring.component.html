<div class="main">
    <div class="info">
        <nz-radio-group
            nzButtonStyle="solid"
            [(ngModel)]="currentCoin"
            (ngModelChange)="onCurrentCoinChange($event)"
        >
            <label
                *ngFor="let coin of coins"
                nz-radio-button
                [nzValue]="coin"
                (click)="showUserStatsHistoryChart()"
            >
                SHA256
            </label>
        </nz-radio-group>

        <nz-table
            class="info-table"
            nzBordered
            [nzTemplateMode]="true"
            [nzLoading]="!userStatsItem"
        >
            <thead>
                <tr>
                    <th>
                        {{ "common.dictionary.acceptedDifficulty" | translate }}
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <span style="font-size: 1.1em;">
                            {{
                                acceptedDifficulty
                                    | suffixify
                                        : { suffix: ESuffixifyPipeSuffix.M }
                            }}
                        </span>
                    </td>
                </tr>
            </tbody>
        </nz-table>

        <nz-table
            class="info-table"
            nzBordered
            [nzTemplateMode]="true"
            [nzLoading]="!userStatsItem"
        >
            <thead>
                <tr>
                    <th>
                        {{ "common.dictionary.workers" | translate }}
                    </th>
                    <th>
                        {{ "common.dictionary.shareRate" | translate }}
                    </th>
                    <th>
                        {{ "common.dictionary.power" | translate }}
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{{ userStatsItem?.workers }}</td>
                    <td>
                        {{
                            userStatsItem?.shareRate
                                | suffixify
                                    : { suffix: ESuffixifyPipeSuffix.ShareRate }
                        }}
                    </td>
                    <td>
                        {{
                            userStatsItem?.power
                                | suffixify
                                    : {
                                          suffix:
                                              ESuffixifyPipeSuffix.PowerTera,
                                          toFixed: 3
                                      }
                        }}
                    </td>
                </tr>
            </tbody>
        </nz-table>

        <nz-table
            class="info-table-mobile"
            nzBordered
            [nzTemplateMode]="true"
            [nzLoading]="!userStatsItem"
        >
            <tbody>
                <tr>
                    <th>
                        {{ "common.dictionary.acceptedDifficulty" | translate }}
                    </th>
                </tr>
                <tr>
                    <td>
                        <span style="font-size: 1.1em;">
                            {{
                                acceptedDifficulty
                                    | suffixify
                                        : { suffix: ESuffixifyPipeSuffix.M }
                            }}
                        </span>
                    </td>
                </tr>
                <tr>
                    <th>
                        {{ "common.dictionary.workers" | translate }}
                    </th>
                </tr>
                <tr>
                    <td>{{ userStatsItem?.workers }}</td>
                </tr>
                <tr>
                    <th>
                        {{ "common.dictionary.shareRate" | translate }}
                    </th>
                </tr>
                <tr>
                    <td>
                        {{
                            userStatsItem?.shareRate
                                | suffixify
                                    : { suffix: ESuffixifyPipeSuffix.ShareRate }
                        }}
                    </td>
                </tr>
                <tr>
                    <th>
                        {{ "common.dictionary.power" | translate }}
                    </th>
                </tr>
                <tr>
                    <td>
                        {{
                            userStatsItem?.power
                                | suffixify
                                    : {
                                          suffix:
                                              ESuffixifyPipeSuffix.PowerTera,
                                          toFixed: 3
                                      }
                        }}
                    </td>
                </tr>
            </tbody>
        </nz-table>
    </div>

    <div class="chart">
        <canvas
            *ngIf="chart"
            style="width: 100%;"
            baseChart
            chartType="line"
            [datasets]="chart.datasets"
            [labels]="chart.labels"
            [options]="chart.options"
        >
        </canvas>
    </div>
</div>

<nz-table
    class="workers-table"
    nzBordered
    [nzTemplateMode]="true"
    [nzLoading]="!userWorkersStatsList"
>
    <thead>
        <tr>
            <th nzWidth="1px"></th>
            <th>
                {{ "common.dictionary.workers" | translate }}
            </th>
            <th>
                {{ "common.dictionary.shareRate" | translate }}
            </th>
            <th>
                {{ "common.dictionary.power" | translate }}
            </th>
            <th>
                {{ "common.dictionary.lastSeen" | translate }}
            </th>
        </tr>
    </thead>
    <tbody *ngIf="userWorkersStatsList">
        <tr
            *ngFor="let item of userWorkersStatsList"
            className="_clickable"
            (click)="onWorkerRowClick(item.name)"
        >
            <td>
                <ng-container [ngSwitch]="getWorkerState(item.lastShareTime)">
                    <i
                        *ngSwitchCase="EWorkerState.Normal"
                        class="worker-state _normal"
                        nz-icon
                        nzType="check-circle"
                        nzTheme="outline"
                    ></i>
                    <i
                        *ngSwitchCase="EWorkerState.Warning"
                        class="worker-state _warning"
                        nz-icon
                        nzType="exclamation-circle"
                        nzTheme="outline"
                    ></i>
                    <i
                        *ngSwitchCase="EWorkerState.Error"
                        class="worker-state _error"
                        nz-icon
                        nzType="minus-circle"
                        nzTheme="outline"
                    ></i>
                </ng-container>
            </td>
            <td>{{ item.name }}</td>
            <td>
                {{
                    item.shareRate
                        | suffixify: { suffix: ESuffixifyPipeSuffix.ShareRate }
                }}
            </td>
            <td>
                {{
                    item.power
                        | suffixify
                            : {
                                  suffix: ESuffixifyPipeSuffix.PowerTera,
                                  toFixed: 3
                              }
                }}
            </td>
            <td>{{ item.lastShareTime | ago }}</td>
        </tr>
    </tbody>
</nz-table>

<div *ngIf="userWorkersStatsList" class="workers-mobile">
    <div
        *ngFor="let item of userWorkersStatsList"
        class="worker-mobile-card"
        (click)="onWorkerRowClick(item.name)"
    >
        <div class="worker-mobile-card-title">
            <ng-container [ngSwitch]="getWorkerState(item.lastShareTime)">
                <i
                    *ngSwitchCase="EWorkerState.Normal"
                    class="worker-state _normal"
                    nz-icon
                    nzType="check-circle"
                    nzTheme="outline"
                ></i>
                <i
                    *ngSwitchCase="EWorkerState.Warning"
                    class="worker-state _warning"
                    nz-icon
                    nzType="exclamation-circle"
                    nzTheme="outline"
                ></i>
                <i
                    *ngSwitchCase="EWorkerState.Error"
                    class="worker-state _error"
                    nz-icon
                    nzType="minus-circle"
                    nzTheme="outline"
                ></i>
            </ng-container>

            <span>{{ item.name }}</span>
        </div>

        <p>
            {{ "common.dictionary.shareRate" | translate }}:
            {{
                item.shareRate
                    | suffixify: { suffix: ESuffixifyPipeSuffix.ShareRate }
            }}
        </p>
        <p>
            {{ "common.dictionary.power" | translate }}:
            {{
                item.power
                    | suffixify
                        : {
                              suffix: ESuffixifyPipeSuffix.PowerTera,
                              toFixed: 3
                          }
            }}
        </p>
        <p>
            {{ "common.dictionary.lastSeen" | translate }}:
            {{ item.lastShareTime | ago }}
        </p>
    </div>
</div>
